# Настройка загрузки изображений в чат

## Что было сделано:

### 1. База данных ✅
- Создана миграция `add_images_to_messages.sql`
- Добавлены поля: `image_url` и `message_type` в таблицу `messages`

**Запустите миграцию:**
```sql
-- Выполните SQL из файла:
my_serve_chat_test/migrations/add_images_to_messages.sql
```

### 2. Сервер ✅
- Создан утилита для загрузки изображений: `utils/uploadImage.js`
- Обновлен контроллер сообщений для поддержки изображений
- Добавлен эндпоинт: `POST /messages/upload-image`
- Обновлены SQL запросы для включения `image_url` и `message_type`
- Добавлена раздача статических файлов для изображений

### 3. Flutter приложение ✅
- Обновлена модель `Message` для поддержки изображений
- Добавлен метод `uploadImage` в `MessagesService`
- Обновлен метод `sendMessage` для поддержки `imageUrl`
- Добавлен UI для выбора и отправки изображений
- Добавлено отображение изображений в сообщениях

## Как использовать:

### Отправка изображения:
1. Нажмите на кнопку с иконкой изображения (слева от поля ввода)
2. Выберите изображение из галереи
3. Превью изображения появится над полем ввода
4. Можете добавить текст к изображению (опционально)
5. Нажмите кнопку отправки

### Просмотр изображения:
- Нажмите на изображение в сообщении для полноэкранного просмотра
- Можно увеличивать/уменьшать масштаб (pinch-to-zoom)
- Нажмите крестик для закрытия

## Настройка сервера:

### Переменные окружения:
Убедитесь, что установлена переменная `BASE_URL` в `.env`:
```
BASE_URL=https://your-server-url.com
```

### Папка для загрузок:
Сервер автоматически создаст папку `uploads/images/` для хранения изображений.

## Ограничения:

- Максимальный размер файла: 10MB
- Поддерживаемые форматы: JPEG, JPG, PNG, GIF, WEBP

## Проверка:

1. Запустите миграцию БД
2. Перезапустите сервер
3. Пересоберите Flutter приложение
4. Попробуйте отправить изображение в чат

